# segment.rules file assigns source code modules to specific banks
# segment.rules is constructed from any segment.rules found in the search path
# the search path is defined in Makefile.cc2430
# segment.rules get processed by a perl snippet listed in the Makefile.cc2430
# the processed output is put into the obj_* directory
# comments starting with "#" are supported
# perl regular expression matching can be used on the file name specification
# 
# general rules -- 
#  some code must be placed in all banks (or SDCC/aslink will complain at link time)
#  code called from function pointers must be in HOME/CSEG/BANK0
#  interrupt code must also be in HOME/CSEG/BANK0
#  code not marked with __banked can only be called from code in the same bank  
#
HOME intr.c  # All interrupt code must live in HOME/BANK0
HOME clock.c  # cannot bank clock.c code because header file is part of core.
HOME uart.c
HOME random.c # header in core/lib. Can not bank this

# Some cc2430 which need special treatment
HOME rtimer-arch.c        # Contains ISRs. Keep it in HOME
HOME watchdog-cc2430.c    # Prototypes in core thus we can't __banked them. Keep this in HOME

# These are safe to put in whatever bank
BANK3 frame802154.c
BANK2 queuebuf.c
BANK3 rimeaddr.c

# Files containing functions invoked via ctimers (FP calls)
# HOME is the safe option. BANK1 "if you know what you're doing"
BANK1 rpl-timers.c
BANK1 neighbor-attr.c

# calls from neighbor-info.c to rpl.c via FPs. Those files need to be in
# the same BANK. rpl defaults to BANK3
BANK3 neighbor-info.c

# Networking code
# Many function calls through pointers with the NETSTACK.
HOME netstack.c
HOME packetbuf.c
HOME packetqueue.c

# Keep those crucial files in the same bank as the NETSTACK
BANK1 sicslowpan.c
BANK1 uip6.c
BANK1 tcpip.c

# Other Port files (cpu/cc2430 stuff)
BANK3 uart_init.c
BANK2 dma.c
HOME cc2430/dev/bus.c
BANK2 cc2430_rf.c     # The radio driver is bankable
BANK1 cc2430/         # cc2430 port in BANK1 if unspecified

# Wildcard rules for anything that hasn't matched so far
BANK1 core/net/mac
BANK1 core/net/rime
BANK3 core/net/rpl
BANK2 core/net
HOME core/            # Crucial and frequently called core functions in HOME
BANK1 .               # Everything else in BANK1
